<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Açougue Portal - Painel Digital</title>
    <style>
        :root {
            --cor-fundo: #0a0a0a;
            --cor-borda: #654321;
            --cor-primaria: #FFD700; /* Dourado */
            --cor-preco: #00FF00;    /* Verde Neon */
            --cor-texto: #ffffff;
            --transicao: 0.8s;
        }

        body {
            background: var(--cor-fundo) url('imagens/fundo.jpg') no-repeat center center fixed;
            background-size: cover;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            color: var(--cor-texto);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            width: 92%;
            height: 85vh;
            background: rgba(0, 0, 0, 0.9);
            border: 6px solid var(--cor-borda);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 0 50px rgba(0,0,0,1);
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            border-bottom: 4px solid var(--cor-primaria);
            margin-bottom: 30px;
            padding-bottom: 10px;
        }

        #titulo-categoria {
            font-size: 4.5em;
            font-weight: 900;
            color: var(--cor-primaria);
            text-transform: uppercase;
            margin: 0;
            letter-spacing: 5px;
            text-shadow: 3px 3px 10px rgba(0,0,0,0.5);
        }

        .conteudo-dinamico {
            flex-grow: 1;
            display: flex;
            gap: 40px;
            transition: opacity var(--transicao) ease-in-out;
        }

        .coluna {
            flex: 1;
            background: rgba(255,255,255,0.03);
            border-radius: 20px;
            padding: 20px;
        }

        .sub-titulo {
            font-size: 2.2em;
            text-align: center;
            color: var(--cor-primaria);
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin-bottom: 20px;
            padding: 5px;
            font-weight: bold;
        }

        .item-tabela {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .item-tabela:last-child { border-bottom: none; }

        .corte {
            font-size: 1.8em;
            font-weight: 700;
            text-transform: uppercase;
        }

        .preco {
            font-size: 2.4em;
            font-weight: 900;
            color: var(--cor-preco);
            font-family: 'Courier New', monospace;
        }

        .fade-out { opacity: 0; }

        /* Rodapé com a Marca */
        .footer-tag {
            text-align: right;
            font-size: 1.5em;
            font-weight: bold;
            color: #ff4444;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1 id="titulo-categoria">CARREGANDO...</h1>
        </div>
        
        <div id="display" class="conteudo-dinamico">
            </div>

        <div class="footer-tag">★ QUALIDADE PORTAL ★</div>
    </div>

    <script>
        let dadosPrecos = null;
        let indexCat = 0;
        const categorias = ['bovinos', 'suinos', 'aves'];

        // 1. Busca os dados (Lê o JSON do GitHub)
        async function fetchDados() {
            try {
                // O timestamp (?t=...) evita que a TV mostre preços antigos guardados no cache
                const resposta = await fetch(`precos.json?t=${new Date().getTime()}`);
                if (!resposta.ok) throw new Error();
                dadosPrecos = await resposta.json();
                
                // Se for o primeiro carregamento, exibe logo
                if (document.getElementById('titulo-categoria').textContent === "CARREGANDO...") {
                    renderizar();
                }
            } catch (e) {
                document.getElementById('titulo-categoria').textContent = "ERRO DE CONEXÃO";
            }
        }

        // 2. Monta o HTML na tela
        function renderizar() {
            if (!dadosPrecos) return;

            const display = document.getElementById('display');
            const titulo = document.getElementById('titulo-categoria');
            const catAtual = categorias[indexCat];

            // Títulos amigáveis
            const nomesTitulos = {
                'bovinos': 'CARNES BOVINAS',
                'suinos': 'CARNES SUÍNAS',
                'aves': 'AVES E OUTROS'
            };

            titulo.textContent = nomesTitulos[catAtual];

            if (catAtual === 'bovinos') {
                // Lógica de 1ª e 2ª (Monitor 1)
                const primeira = dadosPrecos.bovinos.filter(i => i.tipo === 'primeira');
                const segunda = dadosPrecos.bovinos.filter(i => i.tipo === 'segunda');

                display.innerHTML = `
                    <div class="coluna">
                        <div class="sub-titulo">CORTES DE 1ª</div>
                        ${primeira.map(i => criarLinha(i)).join('')}
                    </div>
                    <div class="coluna">
                        <div class="sub-titulo">CORTES DE 2ª</div>
                        ${segunda.map(i => criarLinha(i)).join('')}
                    </div>
                `;
            } else {
                // Outras categorias: divide em 2 colunas genéricas
                const itens = dadosPrecos[catAtual];
                const meio = Math.ceil(itens.length / 2);
                display.innerHTML = `
                    <div class="coluna">${itens.slice(0, meio).map(i => criarLinha(i)).join('')}</div>
                    <div class="coluna">${itens.slice(meio).map(i => criarLinha(i)).join('')}</div>
                `;
            }
        }

        function criarLinha(item) {
            return `
                <div class="item-tabela">
                    <span class="corte">${item.corte}</span>
                    <span class="preco">R$ ${item.preco}</span>
                </div>
            `;
        }

        // 3. Sistema de Rotação (Troca de categoria)
        setInterval(() => {
            const display = document.getElementById('display');
            display.classList.add('fade-out');

            setTimeout(() => {
                indexCat = (indexCat + 1) % categorias.length;
                renderizar();
                display.classList.remove('fade-out');
            }, 800);
        }, 12000); // Troca a cada 12 segundos

        // 4. Sincronização em tempo real (Verifica novos preços a cada minuto)
        fetchDados();
        setInterval(fetchDados, 60000);

    </script>
</body>
</html>
