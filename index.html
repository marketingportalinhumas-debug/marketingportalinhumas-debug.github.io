<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Açougue Portal - Painel Inteligente</title>
    <style>
        :root {
            /* Cores padrão (serão sobrescritas pelo JSON) */
            --bg-body: #000;
            --cor-header: #FFD700;
            --cor-texto: white;
            --cor-preco: #00ff00;
        }

        body {
            background-color: var(--bg-body);
            color: var(--cor-texto);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        .container {
            width: 95vw;
            height: 90vh;
            display: grid;
            grid-template-columns: 1fr 350px; /* Tabela | Oferta */
            gap: 20px;
        }

        /* ÁREA DA TABELA */
        .area-tabela {
            background: rgba(0,0,0,0.8);
            border: 4px solid var(--cor-header);
            border-radius: 20px;
            padding: 25px;
            display: flex;
            flex-direction: column;
        }

        .titulo-principal {
            font-size: 3.5em;
            text-align: center;
            color: var(--cor-header);
            text-transform: uppercase;
            margin: 0 0 20px 0;
            border-bottom: 3px solid var(--cor-header);
        }

        .grid-precos {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .coluna { flex: 1; }
        .sub-titulo {
            font-size: 1.8em;
            text-align: center;
            background: rgba(255,255,255,0.1);
            margin-bottom: 15px;
            border-radius: 5px;
        }

        .item-tabela {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .corte { font-size: 1.4em; font-weight: bold; text-transform: uppercase; }
        .preco { font-size: 1.8em; color: var(--cor-preco); font-family: monospace; }

        /* ÁREA DE OFERTAS (LATERAL) */
        .area-oferta {
            background: #FF4444; /* Cor de alerta */
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            text-align: center;
            animation: pulsar 2s infinite;
        }

        .area-oferta img {
            max-width: 90%;
            border-radius: 15px;
            margin-bottom: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        .oferta-label { font-size: 2em; font-weight: 900; color: white; margin-bottom: 10px; }
        .oferta-nome { font-size: 2.2em; color: yellow; text-transform: uppercase; }
        .oferta-preco { font-size: 4em; color: white; font-weight: 900; }

        @keyframes pulsar {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        #conteudo { transition: opacity 0.6s ease; }
        .fade-out { opacity: 0; }
    </style>
</head>
<body>

    <div class="container">
        <div class="area-tabela">
            <h1 id="titulo-categoria" class="titulo-principal">CARREGANDO...</h1>
            <div id="conteudo">
                <div id="grade" class="grid-precos"></div>
            </div>
        </div>

        <div id="painel-oferta" class="area-oferta">
            <div class="oferta-label">OFERTA DO DIA</div>
            <img id="oferta-img" src="" alt="">
            <div id="oferta-nome" class="oferta-nome"></div>
            <div id="oferta-preco" class="oferta-preco"></div>
        </div>
    </div>

    <script>
        let dados = null;
        let catIndex = 0;
        const categorias = ['bovinos', 'suinos', 'aves'];

        async function carregar() {
            try {
                const res = await fetch(`precos.json?v=${new Date().getTime()}`);
                dados = await res.json();
                
                // Aplica Cores do JSON
                const cfg = dados.config_promocoes;
                document.documentElement.style.setProperty('--bg-body', cfg.bg_color);
                document.documentElement.style.setProperty('--cor-header', cfg.header_color);
                document.documentElement.style.setProperty('--cor-preco', cfg.preco_color);
                document.documentElement.style.setProperty('--cor-texto', cfg.text_color);

                atualizarOferta();
                if (!document.getElementById('grade').innerHTML) mostrar(categorias[0]);
            } catch (e) { console.error("Erro ao carregar JSON"); }
        }

        function atualizarOferta() {
            if (dados.ofertas && dados.ofertas.length > 0) {
                const off = dados.ofertas[0];
                document.getElementById('oferta-img').src = off.imagem;
                document.getElementById('oferta-nome').textContent = off.nome;
                document.getElementById('oferta-preco').textContent = "R$ " + off.preco;
            }
        }

        function mostrar(cat) {
            const grade = document.getElementById('grade');
            const titulo = document.getElementById('titulo-categoria');
            titulo.textContent = cat === 'bovinos' ? "CARNES BOVINAS" : cat.toUpperCase();

            if (cat === 'bovinos') {
                const pri = dados.bovinos.filter(i => i.tipo === 'primeira');
                const seg = dados.bovinos.filter(i => i.tipo === 'segunda');
                grade.innerHTML = `
                    <div class="coluna"><div class="sub-titulo">CORTES 1ª</div>${pri.map(i => linha(i)).join('')}</div>
                    <div class="coluna"><div class="sub-titulo">CORTES 2ª</div>${seg.map(i => linha(i)).join('')}</div>
                `;
            } else {
                const itens = dados[cat];
                const meio = Math.ceil(itens.length / 2);
                grade.innerHTML = `
                    <div class="coluna">${itens.slice(0, meio).map(i => linha(i)).join('')}</div>
                    <div class="coluna">${itens.slice(meio).map(i => linha(i)).join('')}</div>
                `;
            }
        }

        function linha(i) {
            return `<div class="item-tabela"><span class="corte">${i.corte}</span><span class="preco">R$ ${i.preco}</span></div>`;
        }

        // Rotação Automática
        setInterval(() => {
            if (!dados) return;
            const cont = document.getElementById('conteudo');
            cont.classList.add('fade-out');
            setTimeout(() => {
                catIndex = (catIndex + 1) % categorias.length;
                mostrar(categorias[catIndex]);
                cont.classList.remove('fade-out');
            }, 600);
        }, 10000); // 10 segundos por tela

        carregar();
        setInterval(carregar, 60000);
    </script>
</body>
</html>
